import argparse
import os
import s3fs
import time
from chim import ChiMerge
from process import S3FileSystemPatched


def get_data(path, file_idx, no_image=False):
    import pandas as pd
    # import numpy as np
    s3fs.S3FileSystem = S3FileSystemPatched
    fs = s3fs.S3FileSystem()
    """get file list"""
    # input_files = ['part-00002.csv']
    input_files = sorted([file for file in fs.ls(path) if file.find("part-") != -1])
    # input_files = input_files[:2]
    if file_idx is not None:
        input_files = [input_files[file_idx]]

    u = []
    p = []
    index = 0
    for file in input_files:
        print(index)
        index += 1
        p_info = pd.read_csv("s3://" + file, header=None, usecols=[i for i in range(2)]).values
        u_info = pd.read_csv("s3://" + file, header=None, usecols=[i for i in range(2, 153)]).values
        for i in range(u_info.shape[0]):
            p.append((p_info[i]))
            u.append((u_info[i].astype('float32')))
    return p, u


import numpy as np
import pandas as pd

parser = argparse.ArgumentParser()
parser.add_argument(
    "--data_input",
    type=str,
)
parser.add_argument(
    "--data_output",
    type=str
)
args, _ = parser.parse_known_args()
input_data = args.data_input.split(',')[0]
for j in range(505):
    p, df = get_data(input_data, j, no_image=True)
    output = args.data_output
    df = pd.DataFrame(df)
    p = pd.DataFrame(p)
    train_df = df  # .sample(n=len(df) // 10, random_state=2020)
    print('load ok')
    lenss = []
    a = '1*[0,0.597777783870697,0.9986110925674438,1.0,2.026111125946045,3.2725000381469727,3.272777795791626,3.917222261428833,3.9175000190734863,5.947500228881836,5.94777774810791,6.9658331871032715,6.966111183166504,7.0]O2*[0,1.0013889074325562,1.5588889122009277,1.9372222423553467,1.9377777576446533,2.6044445037841797,2.604722261428833,3.0022222995758057,3.002500057220459,3.1372222900390625,3.137500047683716,3.2030556201934814,3.203611135482788,4.487500190734863,7.0]O3*[0,1.0052777528762817,1.159166693687439,1.1594444513320923,1.3600000143051147,1.360277771949768,1.6608333587646484,1.6611111164093018,2.901944398880005,2.902222156524658,3.8516666889190674,3.8519444465637207,4.587500095367432,4.587777614593506,7.0]O4*[0,0.0008333333535119891,0.30944445729255676,0.3097222149372101,0.913611114025116,0.9138888716697693,1.0255556106567383,1.138611078262329,1.1388888359069824,1.1636110544204712,1.1641666889190674,2.4144444465637207,2.4641666412353516,2.4649999141693115,4.357222080230713,7.0]O5*[0,0.0005555555690079927,0.46638888120651245,0.46666666865348816,1.0625,1.0627777576446533,1.4905555248260498,1.4908332824707031,1.902500033378601,1.9027777910232544,2.2561111450195312,2.257499933242798,3.5172221660614014,4.2588887214660645,4.259166717529297,7.0]O6*[0,0.6875,1.011388897895813,1.380833387374878,1.3811111450195312,3.168888807296753,3.1691665649414062,3.605555534362793,3.6058332920074463,3.6861112117767334,3.6863889694213867,4.604166507720947,4.60444450378418,7.0]O7*[0,0.06361111253499985,0.06388889253139496,0.7702777981758118,1.3619444370269775,2.059999942779541,2.0602777004241943,2.820833444595337,2.8211112022399902,3.1205556392669678,3.120833396911621,3.9405555725097656,4.388055324554443,4.390833377838135,7.0]O8*[0,0.8297222256660461,1.0513888597488403,2.17722225189209,2.17805552482605,2.8138887882232666,2.8144445419311523,3.430555582046509,3.430833339691162,3.8788888454437256,3.879166603088379,6.082777976989746,6.083611011505127,7.0]O9*[0,0.08027777820825577,0.5980555415153503,1.0002777576446533,1.605555534362793,2.0052778720855713,4.043889045715332,4.044166564941406,4.345555782318115,4.3458333015441895,4.984444618225098,4.985000133514404,5.8813886642456055,5.88194465637207,7.0]O10*[0,0.4741666615009308,0.6894444227218628,1.0,1.483055591583252,2.0,2.94861102104187,2.9488887786865234,3.7733333110809326,3.773611068725586,5.583889007568359,5.585833549499512,6.940833568572998,6.943055629730225,7.0]O11*[0,0.0019444444915279746,0.08277777582406998,0.616944432258606,0.8019444346427917,0.9972222447395325,1.0002777576446533,1.3650000095367432,2.0138888359069824,2.996666669845581,3.0002777576446533,4.136111259460449,4.136388778686523,5.877222061157227,5.878055572509766,7.2352776527404785]O12*[0,0.0019444444915279746,0.05277777835726738,0.5202777981758118,0.7794444561004639,0.9991666674613953,1.0002777576446533,1.138611078262329,1.4119443893432617,1.9997222423553467,2.0,4.315833568572998,4.316111087799072,6.375833511352539,6.37666654586792,7.542500019073486]O13*[0,0.00027777778450399637,0.4427777826786041,0.6625000238418579,0.8005555272102356,0.9997222423553467,1.0,1.497499942779541,1.9994444847106934,2.0030555725097656,5.149722099304199,5.150277614593506,5.700833320617676,5.701111316680908,6.407777786254883,7.956944465637207]O14*[0,0.46194443106651306,0.7649999856948853,0.9997222423553467,1.0,1.383055567741394,1.765555500984192,1.9997222423553467,2.0,2.691666603088379,3.5450000762939453,3.5452778339385986,4.149444580078125,4.149722099304199,8.328055381774902]O15*[0,0.4236111044883728,0.7602777481079102,0.9997222423553467,1.0,1.175277829170227,1.4613889455795288,1.9991666078567505,2.0,2.5336110591888428,2.533888816833496,3.847777843475342,3.848055601119995,6.080833435058594,8.398333549499512]O16*[0,0.30000001192092896,0.6027777791023254,0.9994444251060486,1.0,1.4008333683013916,1.9997222423553467,2.0,3.6666667461395264,3.6669445037841797,3.8288888931274414,3.8291666507720947,5.873610973358154,5.873888969421387,7.935555458068848]O17*[0,0.0013888889225199819,0.4749999940395355,0.6208333373069763,0.7977777719497681,0.9997222423553467,1.0,1.0872222185134888,1.527500033378601,1.9997222423553467,2.0002777576446533,3.8155555725097656,3.815833330154419,4.624722003936768,8.0]O18*[0,0.31888890266418457,0.5299999713897705,0.8838889002799988,0.9997222423553467,1.0,1.2002778053283691,1.6063889265060425,1.9997222423553467,2.0,2.3769445419311523,2.3772222995758057,4.447500228881836,4.44777774810791,8.0]O19*[0,0.31333333253860474,0.581944465637207,0.7850000262260437,0.9997222423553467,1.0,1.2402777671813965,1.6247222423553467,1.9994444847106934,2.0002777576446533,4.137777805328369,6.2936110496521,6.293889045715332,8.0]O20*[0,0.0033333334140479565,0.3125,0.5730555653572083,0.757777750492096,0.9994444251060486,1.0,1.421944499015808,1.6966667175292969,1.9997222423553467,2.0,4.139166831970215,4.139444351196289,5.766388893127441,5.767499923706055,8.0]O21*[0,0.0008333333535119891,0.2199999988079071,0.5244444608688354,0.7163888812065125,0.9997222423553467,1.0,1.0994443893432617,1.586111068725586,1.9997222423553467,2.001666784286499,2.9997222423553467,3.0030555725097656,4.358055591583252,4.358333110809326,8.0]O22*[0,0.002222222276031971,0.5336111187934875,0.8358333110809326,0.9997222423553467,1.0,1.4524999856948853,1.684166669845581,1.9994444847106934,2.0,2.396111011505127,4.639444351196289,4.6397223472595215,6.2647223472595215,6.264999866485596,8.0]O23*[0,0.0024999999441206455,0.38333332538604736,0.6941666603088379,0.9969444274902344,1.0,1.4469444751739502,1.7530555725097656,1.996666669845581,2.00083327293396,2.706111192703247,2.7063889503479004,5.081666469573975,5.081944465637207,7.7352776527404785,8.0]O24*[0,0.08638888597488403,0.08666666597127914,0.8497222065925598,0.9991666674613953,1.0,1.6291667222976685,1.921944499015808,1.9222222566604614,2.1277778148651123,5.02055549621582,5.020833492279053,5.548888683319092,5.549166679382324,7.999444484710693]O25*[0,1.6555556058883667,3.2133333683013916,3.5366666316986084,5.213889122009277,6.426388740539551,7.755555629730225,9.080833435058594,10.009166717529297,11.542778015136719,17.535554885864258,28.476110458374023,28.476388931274414,41.12138748168945,56.41472244262695,145.2655487060547]O26*[0,1.0,4.0,5.0,6.0,7.0,8.0,9.0,11.0,13.0,15.0,17.0,20.0,26.0,80.0,285.0]O27*[0,1.0,255.0]O28*[0,96.0,156.0,158.0,384.0,388.0,430.0,434.0,458.0,480.0,496.0,580.0,703.0,704.0,729.0,1149361.0]O29*[0,5.0,17.0,28.0,38.0,43.0,50.0,57.0,68.0,77.0,87.0,99.0,112.0,127.0,149.0,150.0]O30*[0]O31*[0]O32*[0]O33*[0,1.0,2.0,3.0,4.0,6.0,9.0,14.0,18.0,28.0,40.0,74.0,472.0,1287.0,10691.0]O34*[0,1.0,2.0,5.0,33.0,115.0,116.0,312.0,313.0,377.0,379.0,528.0,529.0,2690.0]O35*[0,1.0,2.0,3.0,4.0,7.0,9.0,12.0,18.0,30.0,54.0,128.0,129.0,360.0,1539.0]O36*[0,1.0,2.0,17.0,45.0,71.0,83.0,85.0,124.0,125.0,176.0,217.0,278.0,287.0,527.0]O37*[0]O38*[0,1.0,2.0,4.0,36.0,50.0,126.0,127.0,140.0,142.0,294.0,295.0,586.0,590.0,2096.0]O39*[0,5.0,34.0,60.0,62.0,107.0,109.0,148.0,149.0,235.0,244.0,278.0,304.0,883.0]O40*[0,1.0,2.0,4.0,6.0,8.0,10.0,13.0,18.0,25.0,38.0,75.0,378.0,923.0,10640.0]O41*[0]O42*[0]O43*[0,10.0,86.0,88.0,130.0,138.0,156.0,178.0,192.0,318.0,382.0,388.0,488.0,542.0,848.0,116528.0]O44*[0,10.0,22.0,30.0,44.0,50.0,86.0,88.0,100.0,118.0,122.0,190.0,690.0,732.0,53000.0]O45*[0,10.0,15.0,35.0,50.0,65.0,128.0,316.0,328.0,573.0,768.0,4770.0,4778.0,9515.0,109516.0]O46*[0,10.0,15.0,20.0,30.0,50.0,60.0,120.0,128.0,280.0,330.0,380.0,388.0,680.0,30000.0]O47*[0,10.0,20.0,60.0,280.0,451.0,899.0,900.0,999.0,1000.0,1100.0,2128.0,3304.0,5514.0,8041.0,352100.0]O48*[0,74.0,102.0,6691.0,8229.0,10425.0,13821.0,17142.0,19501.0,22456.0,27058.0,40037.0,67544.0,67545.0,112207.0,516326.0]O49*[0,67.0,217.0,696.0,1029.0,1581.0,3322.0,5887.0,8968.0,15245.0,21846.0,41439.0,111286.0,111299.0,510042.0]O50*[0,3.0,24.0,299.0,600.0,1200.0,1201.0,1227.0,1230.0,1843.0,1845.0,2459.0,2460.0,16376.0,16377.0,182037.0]O51*[0,346.0,3727.0,5407.0,8448.0,9777.0,12057.0,14719.0,17530.0,21463.0,25920.0,50155.0,87420.0,153153.0,329405.0]O52*[0]O53*[0,874.0,959.0,998.0,1060.0,1822.0,1980.0,2070.0,2727.0,3057.0,6002.0,9949.0,25756.0,25757.0,72912.0,482921.0]O54*[0,1.0,2.0,3.0,4.0,7.0,13.0,19.0,28.0,36.0,54.0,66.0,99.0,232.0,2508.0]O55*[0,1.0,2.0,3.0,5.0,24.0,39.0,67.0,99.0,141.0,142.0,178.0,180.0,6162.0]O56*[0,9.0,12.0,15.0,18.0,23.0,27.0,32.0,37.0,48.0,59.0,166.0,242.0,438.0,820.0]O57*[0]O58*[0,1.0,2.0,3.0,4.0,5.0,7.0,9.0,11.0,15.0,23.0,55.0,89.0,153.0,1242.0]O59*[0,6.0,20.0,24.0,27.0,32.0,37.0,41.0,46.0,49.0,55.0,64.0,77.0,98.0,234.0,6162.0]O60*[0,1.0,8.0,88.0,116.0,143.0,172.0,219.0,250.0,302.0,351.0,431.0,669.0,1987.0,2745.0,27973.0]O62*[0]O63*[0,0.00015299877850338817,0.0012350761098787189,0.002439874457195401,0.0116243502125144,0.01163241546601057,0.011758118867874146,0.011769651435315609,0.011900334618985653,0.011907843872904778,0.012041284702718258,0.012048192322254181,0.023792358115315437,0.02382134087383747,0.027763495221734047,1.0]O64*[0,0.01666666753590107,0.4786111116409302,0.8869444727897644,0.9997222423553467,1.0005555152893066,1.770277738571167,1.996666669845581,2.003333330154419,2.529444456100464,2.998333215713501,3.9869444370269775,3.987222194671631,4.487500190734863,5.551666736602783,7.0]O65*[0,0.019166667014360428,0.5577777624130249,0.9975000023841858,1.0013889074325562,1.9794445037841797,2.002500057220459,2.694166660308838,2.694444417953491,2.979722261428833,3.8186111450195312,4.818055629730225,5.151666641235352,5.151944637298584,5.818611145019531,7.0]O66*[0,0.03750000149011612,0.03777777776122093,0.12194444239139557,0.12222222238779068,0.9961110949516296,1.0011111497879028,1.7461111545562744,1.7463889122009277,1.9972221851348877,2.5636110305786133,3.7825000286102295,3.782777786254883,5.2158331871032715,5.2166666984558105,7.0]O67*[0,0.009999999776482582,0.6441666483879089,0.7436110973358154,0.7438889145851135,0.9950000047683716,1.6402777433395386,1.640555500984192,2.1424999237060547,2.142777681350708,2.647777795791626,2.6480555534362793,3.393611192703247,4.518055438995361,4.518333435058594,7.0]O68*[0,0.0005555555690079927,0.2938888967037201,0.2941666543483734,0.9877777695655823,1.2938889265060425,1.2941666841506958,1.7599999904632568,1.7602777481079102,1.948888897895813,1.9491666555404663,2.5763888359069824,2.576944351196289,3.0,4.872499942779541,7.0]O69*[0,0.21444444358348846,0.21472221612930298,0.9952777624130249,0.995555579662323,1.995277762413025,1.9958332777023315,2.2833333015441895,2.2836110591888428,2.37416672706604,2.376666784286499,2.658055543899536,2.6583333015441895,4.2216668128967285,7.0]O70*[0,0.5222222208976746,0.9549999833106995,1.0255556106567383,1.0258333683013916,1.9291666746139526,1.929444432258606,2.0061111450195312,2.006666660308838,2.3905556201934814,2.615833282470703,2.6161110401153564,4.111111164093018,4.111388683319092,7.0]O71*[0,0.00027777778450399637,0.4891666769981384,0.48944443464279175,0.9449999928474426,0.945277750492096,0.9997222423553467,1.0049999952316284,1.6911110877990723,1.6913888454437256,1.9905555248260498,2.0,2.261666774749756,2.261944532394409,4.162777900695801,7.0]O72*[0,0.0011111111380159855,0.4580555558204651,0.7066666483879089,0.9997222423553467,1.0002777576446533,1.5777777433395386,1.9997222423553467,2.0,2.4622223377227783,2.4625000953674316,2.998333215713501,3.004166603088379,3.996666669845581,5.003055572509766,7.0]O73*[0,0.34333333373069763,0.7361111044883728,0.9997222423553467,1.0002777576446533,1.2266666889190674,1.704444408416748,1.9997222423553467,2.0,2.426666736602783,2.9997222423553467,3.0,3.9994444847106934,4.996666431427002,7.0]O74*[0,0.4927777647972107,0.7813888788223267,0.9994444251060486,1.0002777576446533,1.5844444036483765,1.9997222423553467,2.0,2.252500057220459,2.9994444847106934,3.0005555152893066,3.9994444847106934,4.999722003936768,5.438055515289307,7.627222061157227]O75*[0,0.3627777695655823,0.6966666579246521,0.9988889098167419,1.0005555152893066,1.5586111545562744,1.9994444847106934,2.0,2.597777843475342,2.9994444847106934,3.0,3.9994444847106934,4.746666431427002,5.957777976989746,8.0]O76*[0,0.41277778148651123,0.7408333420753479,0.9997222423553467,1.0,1.434999942779541,1.9994444847106934,2.0,2.658055543899536,2.9997222423553467,3.0,3.9994444847106934,4.0,4.995833396911621,7.956944465637207]O77*[0,0.0011111111380159855,0.3233333230018616,0.5872222185134888,0.7941666841506958,0.9997222423553467,1.0,1.4972221851348877,1.9997222423553467,2.0,2.48972225189209,2.998333215713501,3.0,3.7030556201934814,4.724722385406494,8.328055381774902]O78*[0,0.0005555555690079927,0.4786111116409302,0.8216666579246521,0.9997222423553467,1.0,1.3313888311386108,1.9997222423553467,2.0,2.6575000286102295,2.9997222423553467,3.0002777576446533,3.2680554389953613,3.9994444847106934,5.102499961853027,8.0]O79*[0,0.4350000023841858,0.7394444346427917,0.9994444251060486,1.0,1.295555591583252,1.7186111211776733,1.9997222423553467,2.0,2.3375000953674316,2.9997222423553467,3.003333330154419,3.9994444847106934,4.929999828338623,8.0]O80*[0,0.261944442987442,0.5883333086967468,0.9997222423553467,1.0,1.1691666841506958,1.5844444036483765,1.9997222423553467,2.0,2.4041666984558105,2.9997222423553467,3.5999999046325684,4.425833225250244,5.369722366333008,8.0]O81*[0,0.4630555510520935,0.6752777695655823,0.9997222423553467,1.0,1.3527777194976807,1.6236110925674438,1.9997222423553467,2.0,2.4200000762939453,2.7316665649414062,3.5002777576446533,4.337500095367432,5.248610973358154,8.0]O82*[0,0.00027777778450399637,0.3194444477558136,0.5105555653572083,0.7505555748939514,0.9997222423553467,1.0002777576446533,1.1863888502120972,1.5225000381469727,1.9997222423553467,2.0002777576446533,2.3891665935516357,2.9997222423553467,3.6786110401153564,4.49305534362793,8.0]O83*[0,0.2872222363948822,0.5513888597488403,0.7672222256660461,0.9997222423553467,1.0,1.2619444131851196,1.6219444274902344,1.9997222423553467,2.0,2.254166603088379,2.9994444847106934,3.9947221279144287,5.249722003936768,8.0]O84*[0,0.28805556893348694,0.570555567741394,0.9113888740539551,0.9997222423553467,1.0,1.3136111497879028,1.9997222423553467,2.0,2.5647222995758057,2.9997222423553467,3.9972221851348877,4.978888988494873,6.935555458068848,8.0]O85*[0,0.00027777778450399637,0.3233333230018616,0.6583333611488342,0.9997222423553467,1.0,1.4766666889190674,1.9997222423553467,2.0,2.3544445037841797,2.9997222423553467,3.0005555152893066,3.593888998031616,4.764999866485596,5.820833206176758,8.0]O86*[0,0.00027777778450399637,0.4238888919353485,0.5455555319786072,0.788611114025116,0.9997222423553467,1.0008333921432495,1.5394444465637207,1.9980555772781372,2.0019445419311523,2.618055582046509,2.9947221279144287,3.998333215713501,4.684722423553467,5.8797221183776855,8.0]O87*[0,0.6677777767181396,0.9902777671813965,1.4161111116409302,1.4163888692855835,1.8008333444595337,2.681666612625122,3.245833396911621,3.8338890075683594,4.4202775955200195,4.9422221183776855,4.942500114440918,6.402500152587891,6.402777671813965,7.997777938842773]O88*[0,0.7552777528762817,1.3186111450195312,2.2572221755981445,3.2333333492279053,5.97944450378418,12.490833282470703,16.2369441986084,23.231111526489258,28.760555267333984,34.66222381591797,39.761112213134766,48.725555419921875,63.426387786865234,75.3324966430664,153.88694763183594]O89*[0,1.0,2.0,3.0,4.0,7.0,11.0,16.0,19.0,23.0,26.0,30.0,34.0,43.0,67.0,280.0]O90*[0,1.0,255.0]O91*[0,32.0,72.0,156.0,158.0,231.0,300.0,328.0,442.0,470.0,604.0,608.0,702.0,710.0,833.0,1149361.0]O92*[0,7.0,16.0,30.0,34.0,39.0,45.0,49.0,54.0,62.0,76.0,84.0,105.0,127.0,149.0,150.0]O93*[0]O94*[0]O95*[0]O96*[0,1.0,3.0,6.0,11.0,27.0,56.0,98.0,127.0,197.0,316.0,583.0,1041.0,8527.0,15547.0]O97*[0,1.0,3.0,5.0,7.0,11.0,17.0,26.0,35.0,68.0,184.0,437.0,510.0,6842.0,15547.0]O98*[0,1.0,2.0,3.0,4.0,5.0,7.0,10.0,14.0,20.0,34.0,46.0,76.0,773.0,2490.0]O99*[0,5.0,7.0,17.0,26.0,51.0,98.0,100.0,125.0,126.0,191.0,193.0,225.0,236.0,548.0]O100*[0]O101*[0,1.0,2.0,3.0,4.0,7.0,12.0,16.0,20.0,33.0,61.0,84.0,125.0,382.0,2038.0]O102*[0,1.0,3.0,7.0,15.0,26.0,32.0,35.0,193.0,196.0,242.0,415.0,484.0,487.0,883.0]O103*[0,1.0,3.0,4.0,7.0,43.0,78.0,120.0,215.0,331.0,463.0,464.0,4289.0,4862.0,15133.0]O104*[0]O105*[0]O106*[0,1.0,10.0,30.0,134.0,138.0,150.0,158.0,176.0,178.0,194.0,198.0,702.0,4584.0,14258.0,184838.0]O107*[0,1.0,10.0,22.0,30.0,44.0,58.0,86.0,88.0,320.0,690.0,700.0,2000.0,4000.0,14794.0,84740.0]O108*[0,15.0,50.0,80.0,310.0,408.0,478.0,758.0,1370.0,5840.0,8986.0,11908.0,11910.0,14080.0,14086.0,109506.0]O109*[0,15.0,20.0,40.0,50.0,60.0,120.0,128.0,280.0,288.0,388.0,1790.0,4040.0,9520.0,9590.0,30000.0]O110*[0,1.0,32.0,402.0,899.0,999.0,1000.0,1099.0,1100.0,2400.0,15718.0,22753.0,34509.0,47784.0,352100.0]O111*[0,1277.0,2736.0,5586.0,6866.0,12176.0,33434.0,46046.0,56483.0,72994.0,95777.0,109969.0,134707.0,159281.0,201092.0,543308.0]O112*[0,1.0,653.0,1609.0,2892.0,4052.0,6657.0,8993.0,12797.0,17647.0,26408.0,31948.0,42043.0,72165.0,148282.0,543308.0]O113*[0,13.0,239.0,618.0,1230.0,2415.0,3603.0,6143.0,8318.0,12379.0,12380.0,17660.0,34234.0,70756.0,182037.0]O114*[0,129.0,314.0,1644.0,3448.0,4701.0,13448.0,20179.0,31025.0,49963.0,65441.0,90745.0,122034.0,148330.0,337579.0]O115*[0]O116*[0,861.0,968.0,1018.0,1305.0,1839.0,1961.0,2030.0,2420.0,57257.0,82845.0,106158.0,143253.0,173781.0,450314.0]O117*[0,2.0,5.0,9.0,15.0,20.0,28.0,44.0,63.0,78.0,101.0,130.0,216.0,629.0,4304.0]O118*[0,1.0,2.0,4.0,5.0,7.0,9.0,12.0,16.0,20.0,31.0,45.0,66.0,128.0,6398.0]O119*[0,3.0,7.0,11.0,40.0,62.0,84.0,124.0,156.0,188.0,209.0,274.0,324.0,437.0,820.0]O120*[0]O121*[0,2.0,16.0,50.0,63.0,75.0,95.0,118.0,142.0,181.0,263.0,342.0,378.0,1242.0]O122*[0,4.0,8.0,13.0,18.0,31.0,62.0,75.0,108.0,133.0,168.0,211.0,275.0,352.0,696.0,6527.0]O123*[0,11.0,29.0,46.0,66.0,92.0,386.0,630.0,875.0,1116.0,1326.0,1535.0,2048.0,2859.0,5692.0,49089.0]O125*[0]O126*[0,0.002728512976318598,0.0053557767532765865,0.00757862813770771,0.009999999776482582,0.045476771891117096,0.047581903636455536,0.04764344170689583,0.049972839653491974,0.05000000074505806,0.05259862169623375,0.052671756595373154,0.05552273988723755,0.09985315799713135,1.0]O127*[0,1.0,2.0,3.0,4.0,7.0,8.0,11.0,12.0,15.0,16.0,19.0,20.0,23.0,172.0]O128*[-49.0,0,1.0,5.0,6.0,9.0,14.0,17.0,22.0,38.0,70.0,151.0,271.0,447.0,943.0,32908.0]O129*[0,1.899999976158142,2.1818182468414307,3.8181817531585693,6.04878044128418,9.75,14.0,17.88888931274414,30.0,33.846153259277344,36.0,78.0,174.0,438.0,1074.25,17852.0]O130*[0,1.0,2.0,3.0,4.0,7.0,8.0,11.0,12.0,15.0,16.0,19.0,20.0,23.0,1370.0]O131*[0,35.0,186.0,375.0,418.0,489.0,614.0,615.0,771.0,839.0,841.0,1252.0,1711.0,5012.0,9660.0,363560.0]O132*[0,136.0,216.0,362.0,420.0,488.0,489.0,615.0,757.0,839.0,841.0,1252.0,1711.0,5012.0,9448.0,365576.0]O133*[0,0.013311147689819336,0.4993742108345032,0.5,0.6659919023513794,0.9882345795631409,0.9976897239685059,0.9987669587135315,0.9992038011550903,0.9995970726013184,0.9999914169311523,2.435424327850342,3.9897959232330322,3.9968228340148926,3.9999516010284424,4.387096881866455]O134*[0,1.0,2.0,3.0,4.0,7.0,8.0,11.0,12.0,15.0,16.0,19.0,20.0,23.0,893.0]O135*[0,1.0,2.0,3.0,4.0,7.0,8.0,11.0,12.0,15.0,16.0,19.0,20.0,24.0,1069.0]O136*[0,1.0,2.0,3.0,4.0,7.0,8.0,11.0,12.0,15.0,16.0,19.0,20.0,24.0,472.0]O137*[0,1.0,2.0,3.0,4.0,5.0,7.0,8.0,11.0,12.0,15.0,16.0,19.0,20.0,428.0]O138*[0,1.0,2.0,3.0,4.0,7.0,8.0,11.0,12.0,15.0,16.0,23.0,24.0,62.0,180.0]O139*[0,1.0,4.0]O140*[0,0.001303780940361321,0.0017301038606092334,0.001733102253638208,0.0034602077212184668,0.003466204507276416,0.005190311465412378,0.0069204154424369335,0.006932409014552832,0.013840830884873867,0.013864818029105663,0.020761245861649513,0.020797226577997208,0.027681661769747734,0.027729636058211327,4.811091899871826]O141*[0,1.7350000143051147,2.654722213745117,4.108611106872559,6.671666622161865,6.671944618225098,7.75,7.750277996063232,11.088889122009277,11.089166641235352,11.889721870422363,11.890000343322754,26.38972282409668,42.0]O142*[0,0.017222221940755844,0.07222222536802292,0.13694444298744202,1.2308332920074463,1.8216667175292969,2.2899999618530273,2.9952778816223145,4.0561113357543945,5.1152777671813965,10.401389122009277,10.401666641235352,12.42638874053955,12.426666259765625,16.64055633544922,34.84222412109375]O143*[0,0.08833333104848862,1.7591667175292969,2.527222156524658,2.9563889503479004,3.6455554962158203,4.598888874053955,5.6591668128967285,6.897500038146973,8.397222518920898,13.258055686950684,13.258333206176758,19.511110305786133,29.51444435119629,42.0]O144*[0,0.021944444626569748,1.7536110877990723,2.435833215713501,2.9605555534362793,3.543888807296753,4.706944465637207,5.460000038146973,6.075833320617676,7.652500152587891,8.987222671508789,13.460833549499512,18.9375,18.93777847290039,28.446666717529297,52.950279235839844]O145*[0,0.00027777778450399637,0.0972222238779068,1.1619443893432617,2.5833332538604736,4.311388969421387,4.311666488647461,5.997222423553467,9.286389350891113,9.286666870117188,14.024999618530273,14.025278091430664,16.267499923706055,22.726667404174805,26.482500076293945,42.0]O146*[0,0.08500000089406967,0.4099999964237213,0.6394444704055786,1.1272221803665161,1.8313888311386108,2.294722318649292,3.6388888359069824,5.159722328186035,7.081666469573975,10.218055725097656,11.9752779006958,14.250555992126465,19.189722061157227,34.84222412109375]O147*[0,0.09111110866069794,0.5311111211776733,1.0319443941116333,1.4208333492279053,2.7041666507720947,4.31944465637207,5.999722003936768,8.466944694519043,10.555000305175781,11.955277442932129,14.01027774810791,18.14611053466797,21.00611114501953,26.690555572509766,45.66777801513672]O148*[0,0.34111112356185913,0.7711111307144165,1.0997222661972046,1.6050000190734863,2.9530556201934814,5.0536112785339355,6.796389102935791,8.653888702392578,11.098055839538574,14.19111156463623,16.688888549804688,19.72361183166504,22.33388900756836,27.584999084472656,52.7863883972168]O149*[0,74.0,100.0,1213.0,6976.0,8296.0,10580.0,12961.0,14595.0,17240.0,19415.0,23419.0,25934.0,36771.0,111970.0,513164.0]O150*[0,1199.0,2727.0,5586.0,7144.0,10792.0,31789.0,43865.0,60933.0,71390.0,92226.0,106418.0,134707.0,201093.0,283127.0,543308.0]'

    b = {}
    for item in a.split('O'):
        ite = item.split('*')
        b[ite[0]] = list(map(float, ite[1][1:-1].split(',')))
    print('bin ok')

    for i in range(1, 151):
        if i == 61 or i == 124:
            lenss.append(0)
            continue
        bin = b[str(i)]
        df[i] = pd.cut(df[i], bin, labels=[j for j in range(len(bin) - 1)], right=False)
        lenss.append(len(bin))
    print(lenss)
    all = pd.concat([p, df], 1)
    block_size = 50000
    n = len(all) // block_size
    for i in range(n):
        all[i * block_size:(i + 1) * block_size].to_csv(output + 'part_' + str(i) + '_' + str(j) + '.csv', sep=',',
                                                        index=False)
    all[n * block_size:].to_csv(output + 'part_' + str(n) + '_' + str(j) + '.csv', sep=',', index=False)
